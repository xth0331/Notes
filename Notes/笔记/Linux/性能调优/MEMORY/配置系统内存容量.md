# 配置系统内存容量

这些内核参数有可能有助于提高系统的内存利用率。通过更改`/proc`文件系统中相应的文件的值来临时设置这些参数以用于测试目的。确定用例生成最佳性能的值后，可以使用`sysctl`命令永久设置它们。

通常通过设置一个或多个内核参数的值来配置内存使用情况。可以通过更改`/proc`文件系统中文件的内容来临时设置这些参数，也可以使用`procps-ng`软件包提供的`sysctl`工具永久设置这些参数。

例如，要将`overcommit_memory`参数临时设置为1：

```bash
echo 1 > /proc/sys/vm/overcommit_memory
```

要永久设置这个值，在`/etc/sysctl.conf`文件中添加`vm.overcommit_memory=1`然后运行：

```bash
sysctl -p
```

临时设置参数对于确定参数对系统的影响很有用。然后，当确定参数的值有所需效果时，可以永久设置参数。

## 虚拟内存参数

> 除非另有说明，否者列出的参数都位于`/proc/sys/vm`中。

- **dirty_ratio**

  百分比值，修改总系统内存的百分比时，系统开始使用`pdflush`操作将修改写入磁盘。默认为`20%`。

- **dirty_background_ratio**

  百分比值，修改系统总内存百分比时，系统开始后台将修改写入磁盘。默认值为`20%`。

- **overcommit_memory**

  定义是接受还是拒接大内存请求的条件。

  默认值为`0`，默认情况下，内核通过估计可用内存量和过大的请求失败来执行启发式内存过量使用处理。但是由于使用启发式而非精准算法分配内存，因此使用此设置可以重载内存。

  当此参数设置为1时，内核不执行内存过量使用处理。增加了内存过载的可能性，但提高了内存密集型任务的性能。

  当此参数设置为`2`时，内核拒绝内存请求等于或大于总可用`SWAP`空间和`overcommit_ratio`中指定的物理RAM的百分比之和。这样可以降低过度使用内存的风险，但建议仅适用于交换区域大于物理内存的系统。

- **overcommit_ratio**

- 