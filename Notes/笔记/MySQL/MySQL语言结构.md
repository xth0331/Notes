# MySQL语言结构

## 字面值

> 这些包括字符串，数字，十六进制和bit，布尔值和NULL。

### String（字符串）

字符串是一个字节或字符序列，包含在单引号（‘）或双引号(“)字符中。例如：

```sql
'a string'
"another string"
```

彼此相邻的带引号的字符串连城一个字符串。以下是等效的：

```sql
'a string'
'a' ' ' 'string'
```

如果`ANSI QUOTES`启用了SQL 模式，则只能在单引号内引用字符串文字，因为在双引号内引用的字符串将被解释为标识符。

二进制字符串是一串字节。每个二进制字符串都有一个字符集和名为`binary`的排序规则。非二进制字符串是一串字符。它具有二进制以外的字符集和与字符集兼容的排序规则。



对于这两种类型的字符串，比较基于字符串单元的数值。对于二进制字符串， 单位是字节；比较使用数字字节值。对于非二进制字符串，单位是字符，一些字符支持多字节字符；比较使用数字字符代码值。字符代码排序是字符串排序规则的一个功能。

字符串文字可以有一个可选的字符集介绍和`COLLATE`子句，将其指定为使用特定字符集和排序规则的字符串。

```mysql
[_charset_name]'string' [COLLATE collation_name]
```

例如：

```mysql
SELECT _latin1'string'；
SELECT _binary'srting';
SELECT _utf8'srting' COLLATE utf8_danish_ci;
```

可以使用`N'literal'`（或`n'literal'`）在国家字符集中创建字符串。这些陈述是等价的：

```mysql
SELECT N'some text';
SELECT n'some text';
SELECT _utf8'some text';
```

在字符串中，除非启用`NO_BACKSLASH_ESCAPES`SQL模式，否则某些序列具有特殊意义。这些序列中的每个都以反斜杠(`\`)开头，称为转义字符。对于所有其他转义序列，将忽略反斜杠。也就是说，转义字符被解释为好像他没有被转义。例如.`\x`就是`x`。这些序列区分大小写。例如`\b`被解释为退格，但`\B`被解释为`B`。根据`character set connection`系统变量只是的字符集合完成转义处理。即使对于之前有指示有不同字符集的介绍的字符串也是如此。

**特殊字符转义序列**

| 转义序列 | 由Sequence表示的字符                      |
| -------- | ----------------------------------------- |
| `\0`     | ASCII NUL（`X'00'`）字符                  |
| `\'`     | 单引号（`'`）字符                         |
| `\"`     | 双引号（`"`）字符                         |
| `\b`     | 退格字符                                  |
| `\n`     | 换行符（换行符）                          |
| `\r`     | 回车符                                    |
| `\t`     | 制表符                                    |
| `\Z`     | ASCII 26（Control + Z）; 见表格后面的注释 |
| `\\`     | 反斜杠（`\`）字符                         |
| `\%`     | 一个`%`角色; 见表格后面的注释             |
| `\_`     | 一个`_`角色; 见表格后面的注释             |

`ASCII 26 `字符可以编码为`\Z`使您能够解决`ASCII 26`代表Windows上的`END-OF-FILE`的问题。如果尝试使用`mysql db_name < file_name`，则文件中的`ASCII 26`会导致问题。

`\%`和`\_`序列用于在模式匹配上下文中搜索`%`和`_`的文字实例，否则它们将被解释为通配符。如果在模式匹配上下文之外使用`\%`和`\_`，则它们将计算字符串`\%`和`\_`而不是`%`和`_`。

有几种方法可以在字符串中包含引号字符：

- 一个`'`带引号的字符串中 `'`可以写成 `''`。
- 一个`"`带引号的字符串中 `"`可以写成 `""`。
- 通过转义字符（`\`）来引用引号字符。
- 一个`'`带引号的字符串内 `"`不需要特殊对待而且不必增加一倍转义。以同样的方式，`"` 引用的字符串里面`'`不需要特殊处理。

以下`SELECT`语句演示了引用和转义的工作原理：

```sql
SELECT 'hello', '"hello"', '""hello""', 'hel''lo', '\'hello';
+-------+---------+-----------+--------+--------+
| hello | "hello" | ""hello"" | hel'lo | 'hello |
+-------+---------+-----------+--------+--------+

SELECT "hello", "'hello'", "''hello''", "hel""lo", "\"hello";
+-------+---------+-----------+--------+--------+
| hello | 'hello' | ''hello'' | hel"lo | "hello |
+-------+---------+-----------+--------+--------+

SELECT 'This\nIs\nFour\nLines';
+--------------------+
| This
Is
Four
Lines |
+--------------------+

SELECT 'disappearing\ backslash';
+------------------------+
| disappearing backslash |
+------------------------+
```

编写应用程序时，在将字符串用作发送到MySQL服务器的SQL语句中的数据值之前，必须正确转义任何可能包含这些特殊字符的字符串。您可以通过两种方式执行此操作：

- 使用转义特殊字符的函数处理字符串。在C程序中，您可以使用`mysql_real_escape_string_quote()` C API函数来转义字符。在构造其他SQL语句的SQL语句中，您可以使用该`QUOTE()`函数。Perl DBI接口提供了`quote` 一种将特殊字符转换为正确转义序列的方法。
- 作为显式转义特殊字符的替代方法，许多MySQL API提供占位符功能，使您能够将特殊标记插入到语句字符串中，然后在发出语句时将数据值绑定到它们。在这种情况下，API负责为您转义值中的特殊字符。





### 数字

数字文字包括精准值（整数和DECIMAL）文字和近似值（浮点）文字。

整数表示为数字序列。数字可以包括小数分隔符（`.`）。数字可以分别在前面加`-`或`+`表示负值或正值。用位数和指数以科学计数法表示的数字是近似值数字。

精确值数字文字具有整数部分或小数部分。或者两者都有。他们可能会标记。例如：`1.2E3`,`1.2E-3`, `-1.2E3`, `-1.2E-3`.

两个看起来想死的数字可能会有不同的对打。例如`2.34`是精确值（定点）数，而`2.34E0`是近似值（浮点数）。

`DECIMAL`数据类型是定点类型，计算是精确的。在MySQL中，`DECIMAL`类型有几个同义词：`NUMERIC`,`DEC`，`FIXED`。整数类型也是精确值类型。

`FLOAT`和`DOUBEL`数据类型是浮点类型，是近似值。在MySQL中，与`FLOAT`或`DOUBLE`同一的类型是`DOUBLE`,`PRECISION`,`REAL`。

整数可以用在浮点上下文中；它被解释为等效的浮点数。



### 日期和时间

日期和时间可以用多种格式表示，例如嗲引号的字符串或数字，具体取决于值的确切类型和其他因素。例如，在MySQL期望的上的下文中，它将‘2015-07-21’，’2015072’和20150721中的任何一个解释为日期。

**标准SQL和ODBC日期和时间字面值。**  标准SQL允许使用类型关键字和字符串指定时态文字。关键字和字符串之间的空格是可选的。

```sql
DATE 'str'
TIME 'str'
TIMESTAMP 'str'
```

MySQL识别这些构造以及相应的ODBC语法：

```clike
{ d 'str' }
{ t 'str' }
{ ts 'str' }
```

MySQL使用type关键字，这些结构分别产生 `DATE`， `TIME`和 `DATETIME`值，如果指定则包括尾部小数秒部分。`TIMESTAMP`语法产生 `DATETIME`在MySQL的价值，因为`DATETIME`有更紧密地对应于标准SQL的范围 `TIMESTAMP`类型，其中有一年范围`0001`到`9999`。（MySQL的`TIMESTAMP`年份范围是`1970`到`2038`。）

**日期和时间上下文中的字符串和数字文字。**  MySQL `DATE`以这些格式识别值：

- 作为字母`'YYYY-MM-DD'`或 `'YY-MM-DD'`格式的字符串。允许使用 “ 宽松 ”语法：任何标点符号都可以用作日期部分之间的分隔符。例如，`'2012-12-31'`，`'2012/12/31'`， `'2012^12^31'`，和 `'2012@12@31'`是相等的。
- 作为字符串中没有分隔符 `'YYYYMMDD'`或`'YYMMDD'` 格式的字符串，前提是该字符串作为日期有意义。例如，`'20070523'`并且 `'070523'`被解释为 `'2007-05-23'`，但是 `'071332'`非法（它具有无意义的月和日部分）并且变为 `'0000-00-00'`。
- 作为数字`YYYYMMDD`或 `YYMMDD`格式的数字，只要该数字作为日期有意义。例如，`19830905`并被`830905` 解释为`'1983-09-05'`。

MySQL 以这些格式识别`DATETIME`和 `TIMESTAMP`评估：

- 作为字母`'YYYY-MM-DD HH:MM:SS'`或`'YY-MM-DD HH:MM:SS'`格式的字符串。这里也允许使用“ 宽松 ”语法：任何标点符号都可以用作日期部分或时间部分之间的分隔符。例如，`'2012-12-31 11:30:45'`， `'2012^12^31 11+30+45'`，`'2012/12/31 11*30*45'`，和 `'2012@12@31 11^30^45'`是相等的。

  在日期和时间部分与小数秒部分之间识别的唯一分隔符是小数点。

  日期和时间部分可以由`T`空格分隔 而不是空格。例如， `'2012-12-31 11:30:45'``'2012-12-31T11:30:45'`是等价的。

- 作为字符串中没有分隔符 `'YYYYMMDDHHMMSS'`或 `'YYMMDDHHMMSS'`格式的字符串，前提是该字符串作为日期有意义。例如， `'20070523091528'`并且`'070523091528'`被解释为 `'2007-05-23 09:15:28'`，但是`'071122129015'`非法（它具有无意义的微小部分）并且变为`'0000-00-00 00:00:00'`。

- 作为数字`YYYYMMDDHHMMSS`或 `YYMMDDHHMMSS`格式的数字，只要该数字作为日期有意义。例如， `19830905132800`并被 `830905132800`解释为 `'1983-09-05 13:28:00'`。

A `DATETIME`或 `TIMESTAMP`值可以包括高达微秒（6位）精度的尾随小数秒部分。小数部分应始终与其余时间分开一个小数点; 没有识别出其他小数秒分隔符。

包含两位数年份值的日期不明确，因为这个世纪是未知的。MySQL使用以下规则解释两位数的年份值：

- 范围`70-99`中的年份值将转换为`1970-1999`。
- 范围`00-69`中的年份值将转换为`2000-2069`。



对于指定为包含日期部分分隔符的字符串的值，不必为小于的月份或日期值指定两个数字`10`。 `'2015-6-9'`是一样的 `'2015-06-09'`。同样，对于指定为包含时间部分分隔符的字符串的值，不必为小于的小时，分钟或秒值指定两个数字`10`。`'2015-10-30 1:2:3'`是一样的`'2015-10-30 01:02:03'`。

指定为数字的值应为6,8,12或14位长。如果一个数字是8或14位长，则假定它是 格式`YYYYMMDD`或`YYYYMMDDHHMMSS`格式，并且年份由前4位数给出。如果数字长度为6或12位，则假定为 格式`YYMMDD`或`YYMMDDHHMMSS`格式，并且年份由前2位数给出。不是这些长度之一的数字被解释为用前导零填充到最接近的长度。





指定为非定界字符串的值将根据其长度进行解释。对于长度为8或14个字符的字符串，假定年份由前4个字符给出。否则，假定年份由前2个字符给出。字符串从左到右解释，以查找字符串中存在的多个部分的年，月，日，小时，分钟和秒值。这意味着您不应使用少于6个字符的字符串。例如，如果您指定`'9903'`，表示代表1999年3月，则MySQL将其转换为“ 零 ”日期值。发生这种情况是因为年和月的值是 `99`和`03`，但是那一天完全没有了。但是，您可以明确指定零值以表示缺少的月份或日期部分。例如，要插入值`'1999-03-00'`，请使用`'990300'`。

MySQL `TIME`以这些格式识别值：

- 作为`'D HH:MM:SS'`格式的字符串。您也可以使用以下的一个“ 宽松 ” 的语法：`'HH:MM:SS'`， `'HH:MM'`，`'D HH:MM'`， `'D HH'`，或`'SS'`。这里 `D`代表天数，可以有0到34之间的值。
- 作为一个没有`'HHMMSS'`格式分隔符的字符串 ，只要它作为时间有意义。例如，`'101112'`被理解为`'10:11:12'`，但是 `'109712'`非法（它有一个荒谬的微小部分）并且变成`'00:00:00'`。
- 作为`HHMMSS`格式中的数字，只要它作为时间有意义。例如， `101112`被理解为`'10:11:12'`。以下备选格式也理解：`SS`， `MMSS`，或`HHMMSS`。

结尾的部分的秒部分在所识别的 `'D HH:MM:SS.fraction'`，`'HH:MM:SS.fraction'`， `'HHMMSS.fraction'`，和 `HHMMSS.fraction`时间的格式，其中， `fraction`是在高达微秒（6位）精度的小数部分。小数部分应始终与其余时间分开一个小数点; 没有识别出其他小数秒分隔符。
对于`TIME`指定为包含时间部件分隔符的字符串的值，不必为小于，小时或秒的值指定两个数字`10`。`'8:3:2'` 是一样的`'08:03:02'`。

### 十六进制数

十六进制文字值使用或 表示法编写 ，其中包含十六进制数字（，）。数字和任何领先的字母都没关系。前导区分大小写，不能写为。 `X'*val*'``0x*val*`*val*`0..9``A..F``X``0x``0X`

合法的十六进制文字：

```sql
X'01AF'
X'01af'
x'01AF'
x'01af'
0x01AF
0x01af
```

非法十六进制文字：

```none
X'0G'   (G is not a hexadecimal digit)
0X01AF  (0X must be written as 0x)
```

使用表示法写入的值 必须包含偶数位数或发生语法错误。要更正此问题，请使用前导零填充值： `X'*val*'`

```sql
mysql> SET @s = X'FFF';
ERROR 1064 (42000): You have an error in your SQL syntax;
check the manual that corresponds to your MySQL server
version for the right syntax to use near 'X'FFF''

mysql> SET @s = X'0FFF';
Query OK, 0 rows affected (0.00 sec)
```

使用包含奇数位数的符号写入的值 被视为具有额外的前导。例如， 被解释为 。`0x*val*``0``0xaaa``0x0aaa`

默认情况下，十六进制文字是二进制字符串，其中每对十六进制数字代表一个字符：

```sql
mysql> SELECT X'4D7953514C', CHARSET(X'4D7953514C');
+---------------+------------------------+
| X'4D7953514C' | CHARSET(X'4D7953514C') |
+---------------+------------------------+
| MySQL         | binary                 |
+---------------+------------------------+
mysql> SELECT 0x5461626c65, CHARSET(0x5461626c65);
+--------------+-----------------------+
| 0x5461626c65 | CHARSET(0x5461626c65) |
+--------------+-----------------------+
| Table        | binary                |
+--------------+-----------------------+
```

十六进制文字可以具有可选的字符集介绍者和`COLLATE`子句，以将其指定为使用特定字符集和排序规则的字符串：





```sql
[_charset_name] X'val' [COLLATE collation_name]
```

例子：

```sql
SELECT _latin1 X'4D7953514C';
SELECT _utf8 0x4D7953514C COLLATE utf8_danish_ci;
```

这些示例使用 符号，但符号也允许引入者。`X'*val*'``0x*val*`

在数字上下文中，MySQL将十六进制文字视为 `BIGINT`（64位整数）。要确保对十六进制文字进行数字处理，请在数字上下文中使用它。这样做的方法包括添加0或使用`CAST(... AS UNSIGNED)`。例如，默认情况下，分配给用户定义变量的十六进制文字是二进制字符串。要将值指定为数字，请在数字上下文中使用它：

```sql
mysql> SET @v1 = X'41';
mysql> SET @v2 = X'41'+0;
mysql> SET @v3 = CAST(X'41' AS UNSIGNED);
mysql> SELECT @v1, @v2, @v3;
+------+------+------+
| @v1  | @v2  | @v3  |
+------+------+------+
| A    |   65 |   65 |
+------+------+------+
```

空十六进制值（`X''`）计算为零长度二进制字符串。转换为数字，它产生0：

```sql
mysql> SELECT CHARSET(X''), LENGTH(X'');
+--------------+-------------+
| CHARSET(X'') | LENGTH(X'') |
+--------------+-------------+
| binary       |           0 |
+--------------+-------------+
mysql> SELECT X''+0;
+-------+
| X''+0 |
+-------+
|     0 |
+-------+
```

该 表示法基于标准SQL。该 表示法基于ODBC，其十六进制字符串通常用于为列提供值。 `X'*val*'``0x``BLOB`

要将字符串或数字转换为十六进制格式的字符串，请使用以下`HEX()`函数：

```sql
mysql> SELECT HEX('cat');
+------------+
| HEX('cat') |
+------------+
| 636174     |
+------------+
mysql> SELECT X'636174';
+-----------+
| X'636174' |
+-----------+
| cat       |
+-----------+
```



### Bit-Value

位值文字是使用或 表示法编写的 。 是使用零和1写的二进制值。任何领导的信件 都没关系。前导区分大小写，不能写为。 `b'*val*'``0b*val*`*val*`b``0b``0B`

合法的比特值文字：

```sql
b'01'
B'01'
0b01
```

非法位值文字：

```none
b'2'    (2 is not a binary digit)
0B01    (0B must be written as 0b)
```

默认情况下，位值文字是二进制字符串：

```sql
mysql> SELECT b'1000001', CHARSET(b'1000001');
+------------+---------------------+
| b'1000001' | CHARSET(b'1000001') |
+------------+---------------------+
| A          | binary              |
+------------+---------------------+
mysql> SELECT 0b1100001, CHARSET(0b1100001);
+-----------+--------------------+
| 0b1100001 | CHARSET(0b1100001) |
+-----------+--------------------+
| a         | binary             |
+-----------+--------------------+
```

位值文字可以具有可选的字符集介绍者和`COLLATE`子句，以将其指定为使用特定字符集和排序规则的字符串：





```sql
[_charset_name] b'val' [COLLATE collation_name]
```

例子：

```sql
SELECT _latin1 b'1000001';
SELECT _utf8 0b1000001 COLLATE utf8_danish_ci;
```


在数字上下文中，MySQL将字面视为整数。要确保对位字面值进行数字处理，请在数字上下文中使用它。这样做的方法包括添加0或使用 `CAST(... AS UNSIGNED)`。例如，默认情况下，分配给用户定义变量的位文字是二进制字符串。要将值指定为数字，请在数字上下文中使用它：

```sql
mysql> SET @v1 = b'1100001';
mysql> SET @v2 = b'1100001'+0;
mysql> SET @v3 = CAST(b'1100001' AS UNSIGNED);
mysql> SELECT @v1, @v2, @v3;
+------+------+------+
| @v1  | @v2  | @v3  |
+------+------+------+
| a    |   97 |   97 |
+------+------+------+
```

空位值（`b''`）计算为零长度二进制字符串。转换为数字，它产生0：

```sql
mysql> SELECT CHARSET(b''), LENGTH(b'');
+--------------+-------------+
| CHARSET(b'') | LENGTH(b'') |
+--------------+-------------+
| binary       |           0 |
+--------------+-------------+
mysql> SELECT b''+0;
+-------+
| b''+0 |
+-------+
|     0 |
+-------+
```

位值表示法便于指定要分配给`BIT`列的值：

```sql
mysql> CREATE TABLE t (b BIT(8));
mysql> INSERT INTO t SET b = b'11111111';
mysql> INSERT INTO t SET b = b'1010';
mysql> INSERT INTO t SET b = b'0101';
```

结果集中的位值将作为二进制值返回，这可能无法很好地显示。要将位值转换为可打印格式，请在数字上下文中使用它或使用转换函数，如 `BIN()`。转换后的值中不显示高位0位数。

```sql
mysql> SELECT b+0, BIN(b), OCT(b), HEX(b) FROM t;
+------+----------+--------+--------+
| b+0  | BIN(b)   | OCT(b) | HEX(b) |
+------+----------+--------+--------+
|  255 | 11111111 | 377    | FF     |
|   10 | 1010     | 12     | A      |
|    5 | 101      | 5      | 5      |
+------+----------+--------+--------+
```



### 布尔值

常数`TRUE`并 分别`FALSE`评估`1`和 `0`。常量名称可以写在任何字母表中。

```sql
mysql> SELECT TRUE, true, FALSE, false;
        -> 1, 1, 0, 0
```

### NULL值

`NULL`值意味着“ 没有数据。“ `NULL`可以用任何字母写成。同义词是`\N`（区分大小写）。治疗 `\N`作为一个同义词`NULL` 在SQL语句被弃用的MySQL 5.7.18，并在MySQL 8.0被删除; 使用`NULL` 来代替。

请注意，该`NULL`值与`0`数值类型或字符串类型的空字符串等值不同。

对于排序方式`ORDER BY`， `NULL`值在升序排序的其他值之前排序，在降序排序的其他值之后排序。