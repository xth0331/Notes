# MySQL语言结构

## 字面值

> 这些包括字符串，数字，十六进制和bit，布尔值和NULL。

### String（字符串）

字符串是一个字节或字符序列，包含在单引号（‘）或双引号(“)字符中。例如：

```sql
'a string'
"another string"
```

彼此相邻的带引号的字符串连城一个字符串。以下是等效的：

```sql
'a string'
'a' ' ' 'string'
```

如果`ANSI QUOTES`启用了SQL 模式，则只能在单引号内引用字符串文字，因为在双引号内引用的字符串将被解释为标识符。

二进制字符串是一串字节。每个二进制字符串都有一个字符集和名为`binary`的排序规则。非二进制字符串是一串字符。它具有二进制以外的字符集和与字符集兼容的排序规则。



对于这两种类型的字符串，比较基于字符串单元的数值。对于二进制字符串， 单位是字节；比较使用数字字节值。对于非二进制字符串，单位是字符，一些字符支持多字节字符；比较使用数字字符代码值。字符代码排序是字符串排序规则的一个功能。

字符串文字可以有一个可选的字符集介绍和`COLLATE`子句，将其指定为使用特定字符集和排序规则的字符串。

```mysql
[_charset_name]'string' [COLLATE collation_name]
```

例如：

```mysql
SELECT _latin1'string'；
SELECT _binary'srting';
SELECT _utf8'srting' COLLATE utf8_danish_ci;
```

可以使用`N'literal'`（或`n'literal'`）在国家字符集中创建字符串。这些陈述是等价的：

```mysql
SELECT N'some text';
SELECT n'some text';
SELECT _utf8'some text';
```

在字符串中，除非启用`NO_BACKSLASH_ESCAPES`SQL模式，否则某些序列具有特殊意义。这些序列中的每个都以反斜杠(`\`)开头，称为转义字符。对于所有其他转义序列，将忽略反斜杠。也就是说，转义字符被解释为好像他没有被转义。例如.`\x`就是`x`。这些序列区分大小写。例如`\b`被解释为退格，但`\B`被解释为`B`。根据`character set connection`系统变量只是的字符集合完成转义处理。即使对于之前有指示有不同字符集的介绍的字符串也是如此。

**特殊字符转义序列**

| 转义序列 | 由Sequence表示的字符                      |
| -------- | ----------------------------------------- |
| `\0`     | ASCII NUL（`X'00'`）字符                  |
| `\'`     | 单引号（`'`）字符                         |
| `\"`     | 双引号（`"`）字符                         |
| `\b`     | 退格字符                                  |
| `\n`     | 换行符（换行符）                          |
| `\r`     | 回车符                                    |
| `\t`     | 制表符                                    |
| `\Z`     | ASCII 26（Control + Z）; 见表格后面的注释 |
| `\\`     | 反斜杠（`\`）字符                         |
| `\%`     | 一个`%`角色; 见表格后面的注释             |
| `\_`     | 一个`_`角色; 见表格后面的注释             |

`ASCII 26 `字符可以编码为`\Z`使您能够解决`ASCII 26`代表Windows上的`END-OF-FILE`的问题。如果尝试使用`mysql db_name < file_name`，则文件中的`ASCII 26`会导致问题。

`\%`和`\_`序列用于在模式匹配上下文中搜索`%`和`_`的文字实例，否则它们将被解释为通配符。如果在模式匹配上下文之外使用`\%`和`\_`，则它们将计算字符串`\%`和`\_`而不是`%`和`_`。

有几种方法可以在字符串中包含引号字符：

- 一个`'`带引号的字符串中 `'`可以写成 `''`。
- 一个`"`带引号的字符串中 `"`可以写成 `""`。
- 通过转义字符（`\`）来引用引号字符。
- 一个`'`带引号的字符串内 `"`不需要特殊对待而且不必增加一倍转义。以同样的方式，`"` 引用的字符串里面`'`不需要特殊处理。

以下`SELECT`语句演示了引用和转义的工作原理：

```sql
SELECT 'hello', '"hello"', '""hello""', 'hel''lo', '\'hello';
+-------+---------+-----------+--------+--------+
| hello | "hello" | ""hello"" | hel'lo | 'hello |
+-------+---------+-----------+--------+--------+

SELECT "hello", "'hello'", "''hello''", "hel""lo", "\"hello";
+-------+---------+-----------+--------+--------+
| hello | 'hello' | ''hello'' | hel"lo | "hello |
+-------+---------+-----------+--------+--------+

SELECT 'This\nIs\nFour\nLines';
+--------------------+
| This
Is
Four
Lines |
+--------------------+

SELECT 'disappearing\ backslash';
+------------------------+
| disappearing backslash |
+------------------------+
```

编写应用程序时，在将字符串用作发送到MySQL服务器的SQL语句中的数据值之前，必须正确转义任何可能包含这些特殊字符的字符串。您可以通过两种方式执行此操作：

- 使用转义特殊字符的函数处理字符串。在C程序中，您可以使用`mysql_real_escape_string_quote()` C API函数来转义字符。在构造其他SQL语句的SQL语句中，您可以使用该`QUOTE()`函数。Perl DBI接口提供了`quote` 一种将特殊字符转换为正确转义序列的方法。
- 作为显式转义特殊字符的替代方法，许多MySQL API提供占位符功能，使您能够将特殊标记插入到语句字符串中，然后在发出语句时将数据值绑定到它们。在这种情况下，API负责为您转义值中的特殊字符。