# NSX-T Data Center概述

与服务器虚拟化以编程方式创建和管理虚拟机的方式相同，NSX-T Data Center网络虚拟化以编程的方式创建和管理基于软件的虚拟网络。

通过网络虚拟化，与网络管理程序功能等效的组件以软件形式再现一整套2-7层网络服务。因此，可通过编程的方式任意组合这些服务，只需短短数秒，即可生成独一无二的独立虚拟网络。

NSX-T Data Center的工作方式是实现三个单独但集成的层面：管理、控制和数据。这些层面是作为两种类型的节点上的一组进程、模块和代理实现的：NSX Manager 和传输节点。

- 每个节点托管一个管理平面代理。
- NSX Manager 节点托管API服务和管理平面集群守护进程。
- NSX Controller 节点托管中央控制平面集群守护进程。
- 传输节点托管本地控制平面守护进程和转发引擎。

NSX Manager 提供了三节点集群支持，再节点集群上合并了策略管理器、管理和中央控制服务。NSX Manager 集群提供用户界面和API的高可用性。管理和控制平面节点的融合减少了必须由NSX-T Data Center管理源布署和管理的虚拟设备数。

针对不同的布署方案，NSX Manager 设备以三种不同的大小提供。

- 小型设备适用于实验和概念证明布署。
- 最多可布署64个主机的中型设备，以及针对布署到大型环境的客户的大型设备。

## 重要概念

常见的NSX-T Data Center概念。

**计算管理器**

计算管理器是一个管理资源（主机和虚拟机）的应用程序。一个示例是vCenter Server。

**控制平面**

根据管理平面的配置计算运行时状态。控制平面传播数据元素报告的拓扑信息，并将无状态配置推送到转发引擎。

**数据平面**

根据控制平面填充的表执行无状态数据包转发或转换。数据平面向控制平面报告拓扑信息以及维护数据包级别统计信息。

**外部网络**

不是由NSX-T Data Center管理的物理网络或VLAN。可以通过NSX Edge 将逻辑网络或覆盖网络连接到外部网络。例如，数据中心的物理网络或物理环境中的VLAN。

**逻辑端口输出**

离开虚拟机或逻辑网络的出站网络流量称为输出，因为流量离开虚拟网络并进入数据中心。

**逻辑端口输入**

离开数据中心并进入虚拟机的入站网络流量称为输入流量。

**逻辑路由器**

NSX-T Data Cetner 路由实体。

**逻辑路由器端口**

可以将逻辑交换机端口或物理网络上的上行链路端口连接到的逻辑网络端口。

**逻辑交换机**

为虚拟机接口和网关接口提供虚拟第二层交换的实体。逻辑交换机为租户网络挂历源提供物理第二层交换机的逻辑等效项，从而允许他们将一组虚拟机连接到一个通用广播域。逻辑交换机是一个独立于物理管理程序基础架构的逻辑实体并跨很多管理程序，从而连接虚拟机而不考虑它们所在的物理位置。

在多租户云中，很多逻辑交换机可能在同一管理程序硬件上并列存在，并且每个第二层分段与其他分段隔离。可以使用逻辑路由器连接逻辑交换机，逻辑路由器可以连接到外部物理网络的上行链路端口。

**逻辑交换机端口**

用于监理到虚拟机网络接口或逻辑路由器接口的连接的逻辑交换机连接点。逻辑交换机端口报告应用的交换配置文件、端口状态和链路状态。

**管理平面**

提供系统的单个API入口点，永久保留用户配置，处理用户查询以及在系统中的所有管理、空盒子和数据平面节点上执行操作任务。管理平面还负责查询、修改和永久保留用户配置。

**NSX Edge集群**

具有高可用性监控中涉及的协议相同的设置的NSX Edge节点设备集合。

**NSX Edge节点**

功能目标是提供计算能力以提供IP路由和IP服务功能的组件。

**NSX管理的虚拟分布式交换机或KVM Open vSwitch**

NSX 管理的虚拟分布式交换机（N-VDS）或OVS用于共享NSX Edge和计算集群。覆盖网络流量配置需要N-VDS。

N-VDS有两种模式：标准和增强型数据路径。增强型数据路径N-VDS的性能功能支持网络功能虚拟化工作负载。

**NSX Manager**

托管API服务、管理平面和代理服务节点。NSX Manager是NSX-T Data Center 安装软件包中包含的一个设备。可以使用NSX Manager或 nsx-cloud-service-manager角色布署该设备。当前，设备一次仅支持一个角色。

**NSX Manager集群**

可以提供高可用性的NSX Manager 集群。

**Open vSwitch**

开源软件虚拟交换机。

**覆盖逻辑网络**

使用“第三层中的第二层”隧道实现的逻辑网络，将虚拟机看到的拓扑从物理网络中解耦出来。

**物理接口**

物理服务器网络接口

**分段**

为虚拟机接口和网关接口提供虚拟机第二层交换的实体。分段为租户网络管理员提供物理第二层交换机的逻辑等效项，从而允许他们将一组虚拟机连接到一个通用广播域。分段是一个独立于物理管理程序基础架构的逻辑实体并跨很多管理程序，从而连接虚拟机而不考虑他们所在的物理位置。分段也称为逻辑交换机。

**Tier-0网关或Tier-0逻辑路由器**

Tier-0网关与物理网络连接，且可以作为活动-活动或活动-备用集群实现。Tier-0网关运行BGP并作为物理路由器的对等项。在活动-备用模式下，该网关还可以提供有状态服务。

**Tier-1网关或Tier-1逻辑路由器**

Tier-1网关连接到一个Tier-0网关以建立北向连接，并连接到一个或多个覆盖网络以建立南向连接。Tier-1网关可以是提供有状态服务的活动-备用集群。

**传输区域**

定义逻辑交换机的最大范围的传输节点集合。传输区域表示一组以类似方式制备的管理程序以及连接这些管理程序上的虚拟机的逻辑交换机。同时已在NSX-T Data Center管理平面中注册并安装了NSX-T Data Center模块。要使管理程序主机或NSX Edge成为NSX-T Data Center覆盖网络的一部分，必须将其添加到NSX-T Data Center 传输区域中。

**上行链路配置文件**

定义管理程序主机到NSX-T Data Center逻辑交换机或NSX Edge节点到架顶式交换机的链路策略。上行链路配置文件定义的设置可能包括绑定策略、活动/备用链路、传输VLAN ID 以及MTU设置。上行链路配置文件中设置的传输VLAN仅标记覆盖网络流量，并且VLAN ID 由 TEP端点使用。

**虚拟机接口**

虚拟机上的网络接口，他在虚拟机客户机操作系统和虚拟交换机之间提供连接。可以讲vNIC连接到一个逻辑端口。可以根据唯一ID（UUID）识别vNIC。

**虚拟隧道端点**

每个挂你来程序具有一个虚拟隧道端点（Virtual Tunnel Endpoint, VTEP）负责虚拟机流量封装在VLAN标头中，并将数据包路由到目标VTEP以进行进一步的处理。可以将流量路由到其他主机或NSX Edge网关上的其他VTEP以访问物理网络。